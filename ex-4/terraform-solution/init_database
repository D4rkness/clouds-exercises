#!/bin/bash

sudo -s

apt-get update
apt-get install -y mariadb-server

# set bind address to local ip
sed -i "s/.*bind-address.*/bind-address = 0.0.0.0/" /etc/mysql/mariadb.conf.d/50-server.cnf

systemctl restart mysql
sleep 5

#  create database, create user, set grants
echo "CREATE DATABASE wikidb;
GRANT ALL PRIVILEGES ON wikidb.* TO 'wikiuser'@'%' IDENTIFIED BY 'geheim'; 
flush privileges; " | mysql -u root

# import dump
echo "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
" | base64 -d > /tmp/dump.sql.gz

cd /tmp/
gunzip dump.sql.gz
mysql -u root wikidb < /tmp/dump.sql
mysql -u root -e "show tables;" wikidb

# fix root login
echo "
UPDATE mysql.user SET password=password('geheim') WHERE user='root';
UPDATE mysql.user SET plugin='' WHERE user='root';
FLUSH PRIVILEGES;" | \
  mysql -u root

# install monitoring
curl -sL https://repos.influxdata.com/influxdb.key | sudo apt-key add -
echo "deb https://repos.influxdata.com/ubuntu xenial stable" \
    | sudo tee /etc/apt/sources.list.d/influxdb.list
sudo apt-get update && sudo apt-get install -y telegraf
## configure telegraf
echo "[global_tags]
[agent]
  interval = \"10s\"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = \"0s\"
  flush_interval = \"10s\"
  flush_jitter = \"0s\"
  precision = \"\"
  debug = false
  quiet = false
  logfile = \"\"
  hostname = \"\"
  omit_hostname = false
[[outputs.influxdb]]
  urls = [\"http://${monitoring-ip}:8086\"] # required
  database = \"telegraf\" # required
  retention_policy = \"\"
  write_consistency = \"any\"
  timeout = \"5s\"
[[inputs.cpu]]
  percpu = true
  totalcpu = true
  collect_cpu_time = false
[[inputs.disk]]
  ignore_fs = [\"tmpfs\", \"devtmpfs\"]
[[inputs.diskio]]
[[inputs.kernel]]
[[inputs.mem]]
[[inputs.processes]]
[[inputs.swap]]
[[inputs.system]]
[[inputs.mysql]]
  servers = [\"root:geheim@unix(/var/run/mysqld/mysqld.sock)/?tls=false\"]
" > /etc/telegraf/telegraf.conf

service telegraf restart